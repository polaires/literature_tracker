{
  "permissions": {
    "allow": [
      "Bash(dir:*)",
      "Bash(winget search:*)",
      "Bash(winget install:*)",
      "Bash(node:*)",
      "Bash(npm:*)",
      "Bash(del App.css)",
      "Bash(git add:*)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(npm run build:*)",
      "Bash(npm install)",
      "Bash(npx tsc -b)",
      "Bash(npx vite build)",
      "Bash(npx tsc:*)",
      "Bash(npm install:*)",
      "Bash(npm run dev:*)",
      "Bash(cat:*)",
      "Bash(tree:*)",
      "Bash(netstat:*)",
      "Bash(findstr:*)",
      "Bash(taskkill:*)",
      "Bash(find:*)",
      "Bash(git checkout:*)",
      "Bash(python3 -c \"\nimport os\ncontent = ''''''import { memo, useState } from ''react'';\nimport { useNavigate } from ''react-router-dom'';\nimport {\n  ArrowLeft,\n  List,\n  Network,\n  Calendar,\n  GitBranch,\n  Plus,\n  ChevronDown,\n  Globe,\n  Upload,\n  PanelLeftClose,\n  PanelLeft,\n  Menu,\n} from ''lucide-react'';\nimport { usePanelContext } from ''../../contexts/PanelContext'';\nimport { Button } from ''../ui'';\nimport { MobileNav } from ''./MobileNav'';\n\nexport type ViewMode = ''list'' | ''graph'' | ''timeline'' | ''arguments'';\n\ninterface TopHeaderProps {\n  thesis: { id: string; title: string; description?: string };\n  viewMode: ViewMode;\n  onViewModeChange: (mode: ViewMode) => void;\n  paperCount: number;\n  connectionCount: number;\n}\n\nfunction BrandLogo({ size = 32 }: { size?: number }) {\n  return (\n    <svg width={size} height={size} viewBox=\"\"0 0 48 48\"\" fill=\"\"none\"\" xmlns=\"\"http://www.w3.org/2000/svg\"\" className=\"\"flex-shrink-0\"\">\n      <defs>\n        <linearGradient id=\"\"headerBrandGradient\"\" x1=\"\"0%\"\" y1=\"\"0%\"\" x2=\"\"100%\"\" y2=\"\"100%\"\">\n          <stop offset=\"\"0%\"\" stopColor=\"\"#6366f1\"\" /><stop offset=\"\"50%\"\" stopColor=\"\"#8b5cf6\"\" /><stop offset=\"\"100%\"\" stopColor=\"\"#a855f7\"\" />\n        </linearGradient>\n        <linearGradient id=\"\"headerNodeGlow\"\" x1=\"\"0%\"\" y1=\"\"0%\"\" x2=\"\"100%\"\" y2=\"\"100%\"\">\n          <stop offset=\"\"0%\"\" stopColor=\"\"#c4b5fd\"\" /><stop offset=\"\"100%\"\" stopColor=\"\"#a78bfa\"\" />\n        </linearGradient>\n      </defs>\n      <circle cx=\"\"24\"\" cy=\"\"24\"\" r=\"\"22\"\" fill=\"\"url(#headerBrandGradient)\"\" />\n      <circle cx=\"\"24\"\" cy=\"\"24\"\" r=\"\"5\"\" fill=\"\"white\"\" />\n      <circle cx=\"\"14\"\" cy=\"\"16\"\" r=\"\"3\"\" fill=\"\"url(#headerNodeGlow)\"\" />\n      <circle cx=\"\"34\"\" cy=\"\"16\"\" r=\"\"3\"\" fill=\"\"url(#headerNodeGlow)\"\" />\n      <circle cx=\"\"12\"\" cy=\"\"30\"\" r=\"\"3\"\" fill=\"\"url(#headerNodeGlow)\"\" />\n      <circle cx=\"\"36\"\" cy=\"\"30\"\" r=\"\"3\"\" fill=\"\"url(#headerNodeGlow)\"\" />\n      <circle cx=\"\"24\"\" cy=\"\"38\"\" r=\"\"3\"\" fill=\"\"url(#headerNodeGlow)\"\" />\n      <line x1=\"\"24\"\" y1=\"\"24\"\" x2=\"\"14\"\" y2=\"\"16\"\" stroke=\"\"white\"\" strokeWidth=\"\"1.5\"\" strokeLinecap=\"\"round\"\" opacity=\"\"0.7\"\" />\n      <line x1=\"\"24\"\" y1=\"\"24\"\" x2=\"\"34\"\" y2=\"\"16\"\" stroke=\"\"white\"\" strokeWidth=\"\"1.5\"\" strokeLinecap=\"\"round\"\" opacity=\"\"0.7\"\" />\n      <line x1=\"\"24\"\" y1=\"\"24\"\" x2=\"\"12\"\" y2=\"\"30\"\" stroke=\"\"white\"\" strokeWidth=\"\"1.5\"\" strokeLinecap=\"\"round\"\" opacity=\"\"0.7\"\" />\n      <line x1=\"\"24\"\" y1=\"\"24\"\" x2=\"\"36\"\" y2=\"\"30\"\" stroke=\"\"white\"\" strokeWidth=\"\"1.5\"\" strokeLinecap=\"\"round\"\" opacity=\"\"0.7\"\" />\n      <line x1=\"\"24\"\" y1=\"\"24\"\" x2=\"\"24\"\" y2=\"\"38\"\" stroke=\"\"white\"\" strokeWidth=\"\"1.5\"\" strokeLinecap=\"\"round\"\" opacity=\"\"0.7\"\" />\n      <line x1=\"\"14\"\" y1=\"\"16\"\" x2=\"\"34\"\" y2=\"\"16\"\" stroke=\"\"white\"\" strokeWidth=\"\"1\"\" strokeLinecap=\"\"round\"\" opacity=\"\"0.4\"\" strokeDasharray=\"\"2 2\"\" />\n      <line x1=\"\"12\"\" y1=\"\"30\"\" x2=\"\"24\"\" y2=\"\"38\"\" stroke=\"\"white\"\" strokeWidth=\"\"1\"\" strokeLinecap=\"\"round\"\" opacity=\"\"0.4\"\" strokeDasharray=\"\"2 2\"\" />\n    </svg>\n  );\n}\n\nexport const TopHeader = memo(function TopHeader({ thesis, viewMode, onViewModeChange, paperCount, connectionCount }: TopHeaderProps) {\n  const navigate = useNavigate();\n  const { leftCollapsed, toggleLeftSidebar, openModal } = usePanelContext();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n\n  const viewModes: { mode: ViewMode; icon: typeof List; label: string }[] = [\n    { mode: \"\"list\"\", icon: List, label: \"\"List\"\" },\n    { mode: \"\"graph\"\", icon: Network, label: \"\"Graph\"\" },\n    { mode: \"\"timeline\"\", icon: Calendar, label: \"\"Timeline\"\" },\n    { mode: \"\"arguments\"\", icon: GitBranch, label: \"\"Arguments\"\" },\n  ];\n\n  return (\n    <>\n      <header className=\"\"h-14 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex items-center px-3 sm:px-4 gap-2 sm:gap-4 flex-shrink-0 relative z-10 safe-area-top\"\">\n        <div className=\"\"flex items-center gap-2 sm:gap-3 min-w-0\"\">\n          <button onClick={() => navigate(\"\"/\"\")} className=\"\"flex items-center gap-2 hover:opacity-80 transition-opacity touch-manipulation\"\" title=\"\"Back to IdeaGraph home\"\">\n            <BrandLogo size={28} />\n            <span className=\"\"text-brand-gradient font-semibold text-lg hidden lg:inline\"\">IdeaGraph</span>\n          </button>\n          <div className=\"\"hidden sm:block w-px h-6 bg-gray-200 dark:bg-gray-700\"\" />\n          <button onClick={() => navigate(\"\"/\"\")} className=\"\"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors sm:hidden touch-manipulation\"\" title=\"\"Back to theses\"\">\n            <ArrowLeft size={18} />\n          </button>\n          <button onClick={toggleLeftSidebar} className=\"\"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors hidden sm:flex lg:hidden touch-manipulation\"\" title={leftCollapsed ? \"\"Show sidebar\"\" : \"\"Hide sidebar\"\"}>\n            {leftCollapsed ? <PanelLeft size={18} /> : <PanelLeftClose size={18} />}\n          </button>\n          <div className=\"\"min-w-0 hidden sm:block\"\">\n            <h1 className=\"\"text-sm font-medium text-gray-600 dark:text-gray-300 truncate max-w-[150px] md:max-w-[200px] lg:max-w-[300px]\"\">{thesis.title}</h1>\n          </div>\n        </div>\n\n        <div className=\"\"flex-1 hidden sm:flex justify-center\"\">\n          <div className=\"\"flex items-center gap-0.5 bg-gray-100 dark:bg-gray-700/50 rounded-xl p-1\"\">\n            {viewModes.map(({ mode, icon: Icon, label }) => {\n              const isActive = viewMode === mode;\n              return (\n                <button key={mode} onClick={() => onViewModeChange(mode)} className={[\"\"flex items-center gap-1.5 px-2 sm:px-3 py-1.5 rounded-lg text-sm font-medium transition-all touch-manipulation\"\", isActive ? \"\"bg-white dark:bg-gray-600 text-indigo-600 dark:text-indigo-400 shadow-sm\"\" : \"\"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 hover:bg-white/50 dark:hover:bg-gray-600/50\"\"].join(\"\" \"\")}>\n                  <Icon size={16} /><span className=\"\"hidden md:inline\"\">{label}</span>\n                </button>\n              );\n            })}\n          </div>\n        </div>\n\n        <div className=\"\"flex-1 sm:hidden flex justify-center\"\">\n          <div className=\"\"flex items-center gap-1.5 px-3 py-1.5 bg-gray-100 dark:bg-gray-700/50 rounded-lg\"\">\n            {(() => { const c = viewModes.find(v => v.mode === viewMode); const I = c?.icon || List; return (<><I size={16} className=\"\"text-indigo-600 dark:text-indigo-400\"\" /><span className=\"\"text-sm font-medium text-indigo-600 dark:text-indigo-400\"\">{c?.label}</span></>); })()}\n          </div>\n        </div>\n\n        <div className=\"\"flex items-center gap-2 sm:gap-3\"\">\n          <div className=\"\"hidden lg:flex items-center gap-2 px-3 py-1 bg-gray-50 dark:bg-gray-700/50 rounded-lg\"\">\n            <span className=\"\"text-sm font-medium text-indigo-600 dark:text-indigo-400\"\">{paperCount}</span><span className=\"\"text-xs text-gray-400\"\">papers</span>\n            <span className=\"\"text-gray-300 dark:text-gray-600\"\">Â·</span>\n            <span className=\"\"text-sm font-medium text-stone-600 dark:text-stone-400\"\">{connectionCount}</span><span className=\"\"text-xs text-gray-400\"\">links</span>\n          </div>\n          <div className=\"\"relative group hidden sm:block\"\">\n            <Button onClick={() => openModal(\"\"addPaper\"\")} icon={<Plus size={18} />} shortcut=\"\"N\"\" title=\"\"Add Paper\"\" className=\"\"btn-brand\"\">\n              <span className=\"\"hidden md:inline\"\">Add</span><ChevronDown size={14} className=\"\"ml-1 hidden md:block\"\" />\n            </Button>\n            <div className=\"\"absolute right-0 top-full mt-1 w-52 bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-700 py-1.5 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all z-20\"\">\n              <button onClick={() => openModal(\"\"addPaper\"\")} className=\"\"w-full px-4 py-2.5 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 hover:text-indigo-600 dark:hover:text-indigo-400 flex items-center gap-3 transition-colors\"\"><Plus size={16} />Add by DOI</button>\n              <button onClick={() => openModal(\"\"searchPaper\"\")} className=\"\"w-full px-4 py-2.5 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 hover:text-indigo-600 dark:hover:text-indigo-400 flex items-center gap-3 transition-colors\"\"><Globe size={16} />Search Semantic Scholar</button>\n              <button onClick={() => openModal(\"\"batchImport\"\")} className=\"\"w-full px-4 py-2.5 text-left text-sm text-gray-700 dark:text-gray-300 hover:bg-indigo-50 dark:hover:bg-indigo-900/20 hover:text-indigo-600 dark:hover:text-indigo-400 flex items-center gap-3 transition-colors\"\"><Upload size={16} />Batch Import DOIs</button>\n            </div>\n          </div>\n          <button onClick={() => setMobileMenuOpen(true)} className=\"\"sm:hidden p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors touch-manipulation\"\" aria-label=\"\"Open menu\"\">\n            <Menu size={20} />\n          </button>\n        </div>\n      </header>\n      <MobileNav isOpen={mobileMenuOpen} onClose={() => setMobileMenuOpen(false)} viewMode={viewMode} onViewModeChange={onViewModeChange} paperCount={paperCount} connectionCount={connectionCount} thesisTitle={thesis.title} />\n    </>\n  );\n});\n''''''\nwith open(''G:/Github_local_repo/literature_tracker/ideagraph/src/components/layout/TopHeader.tsx'', ''w'') as f:\n    f.write(content)\nprint(''Done'')\n\")",
      "Bash(npm ls:*)",
      "Bash(git commit -m \"$(cat <<''EOF''\nAdd AI-assisted PDF reader with usage tracking\n\n- Add standalone PDF reader page at /reader with AI assistant\n- Add AI Assistant Panel with preset actions (summarize, key findings, thesis relevance, methodology, takeaway)\n- Add usage tracking system with $3 free credits (100 credits) for registered users\n- Add admin usage dashboard tab for managing user credits\n- Add prominent \"Read PDF with AI\" button to home page and thesis header\n- Fix infinite loop in useUsage hook by returning static snapshot\n- Fix UsageTab to handle undefined usage gracefully\n- Fix React Fragment key warning in UsageTab\n\nðŸ¤– Generated with [Claude Code](https://claude.com/claude-code)\n\nCo-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>\nEOF\n)\")",
      "Bash(curl:*)",
      "Bash(find C:Usersonewe.claude-worktreesliterature_tracker -type f \\(-name *.ts -o -name *.js -o -name *.tsx \\) -path */src-* -o -name *server* -o -name *api*)"
    ]
  }
}
